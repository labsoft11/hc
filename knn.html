import numpy as np
import pandas as pd
import matplotlib.pyplot as mtp

data = pd.read_csv("User_Data.csv")
x= data.iloc[:,[2,3]].values
y=data.iloc[:,4].values

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test = train_test_split (x,y,test_size=0.26,random_state=0)

from sklearn.preprocessing import StandardScaler
sc=StandardScaler()
x_train = sc.fit_transform(x_train)
x_test = sc.transform(x_test)

from sklearn.neighbors import KNeighborsClassifier
classifier = KNeighborsClassifier (n_neighbors = 5, metric= "minkowski",p=2)
classifier.fit(x_train,y_train)

from sklearn.metrics import confusion_matrix
y_pred= classifier.predict (x_test)
print(confusion_matrix(y_test,y_pred))

from matplotlib.colors import ListedColormap
def plot(x_set, y_set, title):

    x1,x2 = np.meshgrid(
        np.arange (x_set[:,0].min()-1,x_set[:,0].max()+1,0.01),
        np.arange (x_set[:,1].min()-1,x_set[:,1].max()+1,0.01)
        )
    mtp.contourf(
        x1,x2,
        classifier.predict(np.c_[x1.ravel(),x2.ravel()]).reshape(x1.shape),
        alpha=0.75, cmap = ListedColormap(('purple', 'green'))
        )


    for i, j in enumerate(np.unique(y_set)):
        mtp.scatter ( x_set [y_set == j,0], x_set [y_set == j,1], color = ListedColormap(('purple','green'))(i), label = j)
    mtp.title(title)
    mtp.xlabel("AGE")
    mtp.ylabel("Salary")
    mtp.legend()
    mtp.show()

       
# Visualize Training & Test sets
plot(x_train, y_train, "K-NN Algorithm  (Training set)")
plot(x_test, y_test, "K-NN Algorithm  (Testing set)")

